-- initial commands
.headers off
.separator ','

-- (a) Import data
-- [insert sql statement(s) below]
CREATE TABLE athletes(
    id integer,
    sex text,
    dob text,
    height float,
    weight integer,
    nationality text
    );
.import athletes.csv athletes

CREATE TABLE countries(
    country text,
    code text,
    population integer,
    gdp float
);
.import countries.csv countries

CREATE TABLE games(
    id integer,
    name text,
    nationality text,
    sport text,
    gold integer,
    silver integer,
    bronze integer
);
.import games.csv games

-- (b) Build indexes
-- [insert sql statement(s) below]
CREATE INDEX id_index ON athletes(id);
CREATE INDEX nationality_index ON athletes(nationality);
CREATE INDEX id_games_index ON games(id);
CREATE INDEX code_index ON countries(code);

-- (c) Quick computation.
-- [insert sql statement(s) below]


SELECT count(*) FROM games WHERE nationality='USA' AND gold>0;
select '';

-- (d) Distinct Sports.
-- [insert sql statement(s) below]

SELECT DISTINCT(sport) FROM games WHERE nationality='USA' AND gold>0 ORDER BY sport;
select '';

-- (e) Handling Empty Cells.
-- [insert sql statement(s) below]
.mode csv
UPDATE countries SET population = NULL where population = '';
SELECT country, SUM(gold+silver+bronze) FROM countries INNER JOIN games ON code=nationality GROUP BY country ORDER BY population DESC LIMIT 5;
.mode list
select '';

-- (f) Female Athletes.
-- [insert sql statement(s) below]
.mode csv
SELECT c.country, SUM(g.gold) gs from countries c INNER JOIN games g ON c.code=g.nationality INNER JOIN athletes a on g.id = a.id WHERE a.sex='female' AND g.gold > 0 GROUP BY country ORDER BY gs DESC LIMIT 5;
.mode list
select '';

-- (g) Fit Athletes
-- [insert sql statement(s) below]
.mode csv
SELECT g.name, (a.weight/(a.height*a.height)) bmi FROM games g INNER JOIN athletes a ON g.id = a.id WHERE bmi >= 18.5 AND bmi <= 24.9 ORDER BY g.name, bmi DESC LIMIT 10;
.mode list
select '';

-- (h) Percentages of Gold & Silver Medals.
-- [insert sql statement(s) below]


select '';

-- (i) Creating a view.
-- [insert sql statement(s) below]


select '';

-- (j) Count total pairs.
-- [insert sql statement(s) below]


select '';

-- (k) Create and import data into FTS table movie_overview.
-- [insert sql statement(s) below]


-- (k) part 1
-- [insert sql statement(s) below]


select '';

-- (k) part 2
-- [insert sql statement(s) below]


select '';

-- (k) part 3
-- [insert sql statement(s) below]
